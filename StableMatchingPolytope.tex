\documentclass[preprint]{elsarticle}
%\usepackage[margin=1in, bottom=1in, top=1in]{geometry} %1 inch margins
\usepackage{amsmath, amssymb, amstext}
\usepackage{fancyhdr}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{mathtools}
\usepackage{theorem}

\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

%Theorem
\newtheorem{fact}{Fact}[section]
\newtheorem{lemma}[fact]{Lemma}
\newtheorem{theorem}[fact]{Theorem}
\newtheorem{definition}[fact]{Definition}
\newtheorem{corollary}[fact]{Corollary}
\newtheorem{proposition}[fact]{Proposition}
\newtheorem{claim}[fact]{Claim}
\newtheorem{exercise}[fact]{Exercise}
\newtheorem{note}[fact]{Note}
\newenvironment{proof}{{\bf Proof:  }}{\hfill\rule{2mm}{2mm}}
%Macros
\newcommand{\A}{\mathbb{A}} \newcommand{\C}{\mathbb{C}}
\newcommand{\D}{\mathbb{D}} \newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathbb{N}} \newcommand{\R}{\mathbb{R}}
\newcommand{\T}{\mathbb{T}} \newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
 
 
\newcommand{\cA}{\mathcal{A}} \newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}} \newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}} \newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}} \newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}} \newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}} \newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}} \newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}} \newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}} \newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}} \newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}} \newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}} \newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}} \newcommand{\cZ}{\mathcal{Z}}


\begin{document}
\begin{frontmatter}
%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{<author name>}
%% \address[label1]{<address>}
%% \address[label2]{<address>}

\title{An Inductive Proof of Integrality for the Stable Matching Polytope}
\author[co]{Jochen K\"{o}nemann}
\author[co]{Kanstantsin Pashkovich}
\author[co]{Justin Toth\corref{cor1}}
\ead{wjtoth@uwaterloo.ca}
\address[co]{Department of Combinatorics and Optimization, University of Waterloo, Canada}

\cortext[cor1]{Corresponding author}

\begin{abstract}
We give an alternative, inductive proof of integrality for Rothblum's characterization of Stable Matchings as extreme points of a polytope.
\end{abstract}
\begin{keyword}
Stable Matching\sep Polytope\sep Extreme Points
\end{keyword}
\end{frontmatter}
\section{Stable Matching Alternating Paths}
\paragraph{}
Let $G = (V, E)$ be a bipartite graph with $V = V_0 \dot\cup V_1$. If we assign for each vertex a list of preferences with respect to that vertex's neighbours then we have a stable matching instance. Let $v,w \in V$, define $\delta^{>w}(v) = \{vj \in \delta(v): j \text{ is strictly preferred to } w \text{ by } v\}$. Also define $ \delta^{\geq w}(v), \delta^{<w}(v),$ etc, similarly. Let $n^*(v)$ ($n_*(v)$ respectively) denote the most (least respectively) preferred elements of the neighbourhood of $v$. For any matching $M$ let $M(v)$ denote the vertex such that $vM(v) \in M$. Let $M_1$ and $M_2$ be two stable matchings on $G$.
\begin{lemma}
Let $C$ be a connected component of the subgraph of $G$ with edge set $M_1 \triangle M_2$. Then either all vertices in $V(C) \cap V_0$ prefer $M_1$ to $M_2$ and all vertices in $V(C) \cap V_1$ prefer $M_2$ to $M_1$, or vice versa.
\label{lemma:pref}
\end{lemma}
\begin{proof}
If $C$ is a path let $v$ be an end vertex of $C$, otherwise let $v$ be an arbitrary vertex of $C$. We may assume without loss of generality that $v \in V_0$ and $M_1(v) >_v M_2(v)$. Let $w = M_1(v)$. Then $w \in V(C)$. If $M_1(w) >_w M_2(w)$ then $vw$ blocks $M_2$. So $M_2(w) >_w M_1(w)$. Let $u=M_2(w)$. Then $u \in V(C)$. If $M_2(u) >_u M_1(u)$ then $uw$ blocks $M_1$. So $M_1(u) >_u M_2(u)$. This local structure can be extended forward to hit all edges in the connected component.
\end{proof}

\begin{lemma} From Lemma \ref{lemma:pref}, $M_1 \triangle M_2$ is a collection of paths and cycles which can be partitioned into two sets $J_1$ and $J_2$ as follows. Let $J_1$ contain the connected components whose vertices in $V_0$ prefer $M_1$ to $M_2$, and let $J_2$ contain the connected components whose vertices in $V_1$ prefer $M_1$ to $M_2$. Then $M_1 \triangle J_1$ and $M_1 \triangle J_2$ are stable matchings.
\label{lemma:symstable}
\end{lemma}
\begin{proof}
Suppose for a contradiction there is a blocking pair $ab \in E$ with $a \in V_0$ and $b \in V_1$. Let $i,j \in \{1,2\}$ such that $M_1\triangle J_1(a) = M_i(a)$ and $M(b) = M_j(b)$. Since $ab$ is blocking,
$$b >_a M_i(a) \text{ and } a >_b M_j(b). $$
If $i=j$ then $ab$ blocks $M_i$, a contradiction. So $i \neq j$. Since $M_i$ is stable $M_i(b) >_b a$, and since $M_j$ is stable $M_j(a) >_a b$. That is,
$$M_j(a) >_a M_i(a) \text{ and } M_i(b) >_b M_j(b).$$
Thus $a,b \in V(J_j)$, which implies $i=j=2$, a contradiction.
\end{proof}
\section{Stable Matching Polytope}
\paragraph{}
Let $Q(G)$ be polytope described by the set of vectors $x \in \R^E$ satisfying:
\begin{align*}
x(\delta(v)) &\leq 1 &\forall v \in V\\
x(\delta^{>w}(v))+ x(\delta^{>v}(w)) + x_{vw} &\geq 1 &\forall vw \in E \\
x_e &\geq 0 &\forall e \in E.
\end{align*}
Where $x(F) = \sum_{e \in F} x_e$ for any $F \subseteq E$.
\subsection{Finding a $0$ or $1$}

\begin{lemma}
Let $x$ be an extreme point solution to $Q(G)$ such that $x>0$. Then there exists $W \subseteq V$ and $T \subseteq E$ such that the following hold:
\label{lemma:rank}
\begin{enumerate}
\item $x(\delta(v)) = 1$, $\forall v \in W$.
\item $x(\delta^{>w}(v)) + x(\delta^{>v}(w)) + x_{vw} = 1$, $\forall vw \in T$.
\item The vectors in $\{\chi(\delta(v)) : v \in W\}$ together with the vectors in $\{\chi(\delta^{>w}(v)) + \chi(\delta^{>v}(w)) + \chi(vw) : vw \in T\}$ are all linearly independent.
\item $|W| + |T| = |E|$.
\end{enumerate}
\end{lemma}
\begin{proof}
Immediate from Rank Lemma \cite{lau2011iterative}. 
\end{proof}
\begin{lemma}
Let $x$ be an extreme point solution of $Q(G)$ such that $0 < x < 1$. Let $W \subseteq V$, and $T \subseteq E$ be sets that together satisfy $1-4$ of Lemma \ref{lemma:rank}. If $W$ and $T$ are chosen so that $|W|$ is maximized then for any $v \in V$ if $w = n^*(v)$ then $vw \not\in T$.
\label{lemma:fav}
\end{lemma}
\begin{proof}
Let $v \in V$, let $w = n^*(v)$ and suppose for a contradiction that $vw \in T$. Then 
$$x(\delta^{>v}(w)) + x(\delta^{>w}(v)) + x_{vw} = 1. $$
Since $w = n^*(v)$, $\chi(\delta^{>w}(v)) = 0$. Therefore we have
$$x(\delta^{\geq v}(w)) = 1.$$
Since $x(\delta(w)) \leq 1$ and $\delta(w) = \delta^{\geq v}(w) \dot\cup \delta^{< v}(w)$, $$x(\delta^{<v}(w) = 0. $$
Therefore, since $x_e > 0$ for each $e \in \delta^{< v}(w)$, $$\chi(\delta^{< v}(w)) = 0.$$
Then we have that
\begin{align*}
\chi(\delta(w)) &= \chi(\delta^{\geq v}(w)) + \chi(\delta^{<v}(w)) \\
&= \chi(\delta^{\geq v}(w)) \\
&= \chi(\delta^{> v}(w)) + \chi(\delta^{> w}(v)) + \chi(vw).
\end{align*}
So if $w \in W$ this contradicts condition $3$ of Lemma \ref{lemma:rank}, the linear independence. But if $w \not\in W$ then by the equivalence just demonstrated the sets $W' = W \cup \{w\}$ and $T' = T \backslash \{vw\}$ also satisfy $1-4$ of Lemma \ref{lemma:rank} yet $|W'| > |W|$ contradicting the maximality of $|W|$. 
\end{proof}
\begin{lemma}
Let $x$ be an extreme point solution of $Q(G)$. Then there exists $e \in E$ such that $x_e = 0$ or $x_e = 1$.
\label{lemma:01}
\end{lemma}
\begin{proof}
Suppose for contradiction that $0 < x_e < 1$ for all $e \in E$. By Lemma \ref{lemma:rank} there exists $W, T$ satisfying properties $1-4$ of Lemma \ref{lemma:rank}. Choose such $W$ and $T$ so that $|W|$ is maximized. First notice that
$$d_E(v) \geq 2 $$
for all $v \in W$. This follows since $x(\delta(v)) = 1$ and $x_e < 1$ for each $e \in \delta(v)$.
\paragraph{}
Let $v \in W$. Let $w = n_*(v)$. We claim that $vw \not\in T$. Suppose for a contradiction that $vw \in T$. Then we would have:
$$  x(\delta^{>w}(v)) + x(\delta^{>v}(w)) + x_{vw} = 1. $$
But since $w=n_*(v)$, $\chi(\delta^{<w}(v)) = 0$. Thus $\delta^{\geq w}(v) = \delta(v)$. Therefore
$$x(\delta^{>w}(v)) + x_{vw} = x(\delta(v)) = 1 \text{ since $v \in W$}. $$
So we have that $ x(\delta^{>v}(w)) = 0 $. That is $\chi(\delta^{>v}(w)) = 0.$
Therefore $$ \chi(\delta^{>w}(v)) + \chi(\delta^{>v}(w)) + \chi(vw) = \chi(\delta^{>w}(v)) + \chi(vw) = \chi(\delta(v)). $$
Since $v \in W$ this tells us that condition $3$ of Lemma \ref{lemma:rank} is violated, a contradiction. Therefore $vw \not\in T$.
\paragraph{}
Now for any $v \in V$, by Lemma \ref{lemma:fav}, $vn^*(v) \not\in T$. Since $d_E(v) \geq 2$ implies that $n^*(v) \neq n_*(v)$ we thus have that $d_{E\backslash T}(v) \geq 2$ for all $v \in W$.
\paragraph{}
We are now ready to give a fractional token counting argument to obtain the desired contradiction. To each $e \in E$ we will distribute one token. Redistribute the tokens according to the following rules. For any $e=vw \in E$ do:
\begin{enumerate}
\item If $e \in T$ then $e$ keeps its token,
\item otherwise:
\subitem if $v \in W$ then $e$ gives $\frac{1}{2}$ token to $v$,
\subitem if $w \in W$ then $e$ give $\frac{1}{2}$ token to $w$.
\end{enumerate}
Then after redistribution by rule $1$ every $e \in T$ has a token. Let $v \in W$. By our previous arguments $d_{E\backslash T}(v) \geq 2$. So there exist at least two edges which each give $\frac{1}{2}$ token to $v$. Therefore $v$ has at least one token after redistribution.
\paragraph{}
We claim that there exist $v \in V\backslash W$. Suppose not, that is $W = V = V_0 \dot\cup V_1$. Then
\begin{align*}
\sum_{v \in V_0} \chi(\delta(v)) &= \chi(\delta(V_0)) \\
&= \chi(\delta(V_1)) &\text{since $G$ is bipartite} \\
&= \sum_{v \in V_1} \chi(\delta(v)).
\end{align*}
Since $V_0, V_1 \subseteq W$ this contradicts Lemma \ref{lemma:rank} part $3$. Therefore there exists $v \in V \backslash W$. Let $w = n^*(v)$. Let $e = vw \in E$. By Lemma \ref{lemma:rank}, $e \not \in T$. Since $v \not\in W$, $e$ keeps at least $\frac{1}{2}$ token. Therefore $|E| > |W| + |T|$ contradicting condition $4$ of Lemma \ref{lemma:rank}. 
\end{proof}

\subsection{Proof of Integrality}
\begin{theorem}
$Q(G)$ is integral.
\end{theorem}
\begin{proof}
Note that it is clear the integral points of $Q(G)$ describe stable matchings of $G$\cite{rothblum1992characterization}. The argument proceeds by induction on $|E|$. Notice in the base case $|E| = 1$, it is immediate that $Q(G) = \{1\}$.
\paragraph{}
Consider the inductive case. Let $x$ be an extreme point of $Q(G)$. By Lemma \ref{lemma:01} exists $e=vw \in E(G)$ such that $x_e = 0$ or $x_e = 1$. 
\paragraph{}
Consider the case $x_e = 0$. If $x$ is fractional then the residual vector, $z$, acquired by restricting $x$ to $\R^{E\backslash\{e\}}$, is fractional. Notice that $z \in Q(G-e)$. Further it is not difficult to show that $x$ satisfies:
$$x(\delta^{>w}(v))+ x(\delta^{>v}(w)) + x_{vw} = 1$$
and so $z$ lies on an edge of $Q(G-e)$ (the hyperplane above intersects this edge) . Let $M_1$ and $M_2$ be the stable matchings given by the extreme points of $Q(G-e)$ which describe the edge that $z$ lies on.
\paragraph{}
Without loss of generality we may assume
$$ |M_1 \cap(\delta^{>w}(v) \cup \delta^{>v}(w))| = 2 $$
and 
$$ |M_2 \cap(\{vw\} \cup \delta^{>w}(v) \cup \delta^{>v}(w))| = 0.$$
To see this notice that if $|M_1 \cap(\delta^{>w}(v) \cup \delta^{>v}(w))| = 1$ then $M_1$ would satisfy $$x(\delta^{>w}(v))+ x(\delta^{>v}(w)) + x_{vw} = 1$$ and $z$ would be the incidence vector of $M_1$, contradicting that $z$ is fractional. Similar for $M_2$.
\paragraph{}
Define $J_1$ and $J_2$ as in Lemma \ref{lemma:symstable}. Since $|M_1 \cap(\delta^{>w}(v) \cup \delta^{>v}(w))| = 2$, neither $J_1$ nor $J_2$ are empty. Therefore $M_1 \triangle J_1$ and $M_2 \triangle J_2$ are distinct matchings from $M_1$ and $M_2$.
\paragraph{}
Further it can be seen that
\begin{align*}
&\chi(M_1 \triangle J_1) + \chi(M_1 \triangle J_2)\\
&= (\chi(M_1) + \chi(J_1) - 2\chi(M_1 \cap J_1)) + (\chi(M_1) + \chi(J_2) -2\chi(M_1 \cap J_2))\\
&=2\chi(M_1) + \chi(J_1) + \chi(J_2) -2(\chi(M_1 \cap J_1) + \chi(M_2 \cap J_2)) \\
&= 2\chi(M_1) + \chi(M_1 \triangle M_2) - 2(\chi(M_1) + \chi(M_1 \cap M_2)) \\
&= \chi(M_1 \triangle M_2) + 2\chi(M_1 \cap M_2) \\
&=\chi(M_1) + \chi(M_2).
\end{align*}
\paragraph{}By Lemma \ref{lemma:symstable}, $M_1 \triangle J_1$ and $M_1 \triangle J_2$ are stable. This contradicts that $M_1$ and $M_2$ are described by extreme points defining at edge of $Q(G-e)$.
\paragraph{}
In the case $x_e = 1$, if there exists $e' \in \delta(v) \cup \delta(w) \backslash \{e\}$ then $x_{e'} = 0$ and so we may obtain a contradiction by removing $e'$ as we did in the $x_e = 0$ case. Otherwise let $z$ be the vector acquired by restricting $x$ to $\R^{E \backslash \{e\}}$. Notice $z \in Q(G - v - w)$. If $z$ is not a vertex then there exists $z^1, z^2 \in Q(G-v-w)$ such that $z = \frac{1}{2}(z^1 + z^2)$. Now $z^1,z^2$ can be extended to vectors $x^1, x^2 \in \R^{E}$ by setting $x^1_e=x^2_e = 1$. Then $x^1,x^2 \in Q(G)$ and $x = \frac{1}{2}(x^1 + x^2)$, contradicting that $x$ is a vertex of $Q(G)$. Therefore $z$ is a vertex of $Q(G-v-w)$, thus integral, and so $x$ is integral.
\end{proof}
\bibliography{StableMatchingPolytopeReferences}
\end{document}
