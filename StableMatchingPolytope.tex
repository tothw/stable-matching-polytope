\documentclass[preprint]{elsarticle}
%\usepackage[margin=1in, bottom=1in, top=1in]{geometry} %1 inch margins
\usepackage{amsmath, amssymb, amstext}
\usepackage{fancyhdr}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{mathtools}
\usepackage{theorem}
\usepackage{xcolor}

\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

%Theorem
\newtheorem{fact}{Fact}[section]
\newtheorem{lemma}[fact]{Lemma}
\newtheorem{theorem}[fact]{Theorem}
\newtheorem{definition}[fact]{Definition}
\newtheorem{corollary}[fact]{Corollary}
\newtheorem{proposition}[fact]{Proposition}
\newtheorem{claim}[fact]{Claim}
\newtheorem{exercise}[fact]{Exercise}
\newtheorem{note}[fact]{Note}
\newenvironment{proof}{{\bf Proof:  }}{\hfill\rule{2mm}{2mm}}
%Macros
\newcommand{\A}{\mathbb{A}} \newcommand{\C}{\mathbb{C}}
\newcommand{\D}{\mathbb{D}} \newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathbb{N}} \newcommand{\R}{\mathbb{R}}
\newcommand{\T}{\mathbb{T}} \newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
 
 
\newcommand{\cA}{\mathcal{A}} \newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}} \newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}} \newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}} \newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}} \newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}} \newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}} \newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}} \newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}} \newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}} \newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}} \newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}} \newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}} \newcommand{\cZ}{\mathcal{Z}}


\DeclareMathOperator{\convOp}{conv}
\newcommand{\conv}{\convOp}


\begin{document}
\begin{frontmatter}
%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{<author name>}
%% \address[label1]{<address>}
%% \address[label2]{<address>}

\title{Linear Description for Stable Matching Polytope: Alternative Proof}
\author[co]{Jochen K\"{o}nemann}
\author[co]{Kanstantsin Pashkovich}
\author[co]{Justin Toth\corref{cor1}}
\ead{wjtoth@uwaterloo.ca}
\address[co]{Department of Combinatorics and Optimization, University of Waterloo, Canada}

\cortext[cor1]{Corresponding author}

\begin{abstract}
In this paper we provide an alternative proof for the description.
\end{abstract}
\begin{keyword}
Stable Matching\sep Polytope\sep Extreme Points
\end{keyword}
\end{frontmatter}
\section{Stable Matching Polytope}

Let $G = (V, E)$ be a bipartite graph  where the bipartition is given by node sets $\mathcal{A}$ and $\mathcal{B}$. Moreover, each node $a\in\mathcal{A}$ defines a total ordering $>_a$ on its neighbour nodes $N(a):=\{b \in\mathcal{B}: \{a,b\}\in E\}$;  the same holds for nodes in $\mathcal{B}$.

Let us introduce the following notation. For $a\in \mathcal{A}$ and $u \in N(\mathcal{A})$, we can define $\delta^{>b}(a):=\{ \{a,\beta\}\in E: \beta>_a b \}$. We can define $\delta^{>a}(b)$, $\delta^{\leq b}(a)$, $\delta^{\geq b}(a)$, etc, similarly. For $a\in \mathcal{A}$ let $N_{\max}(a)$ denote the maximum element in $N(a)$ with respect to $>_a$, analogously define $N_{\max}(b)$ for $b\in\mathcal{B}$. 

Given a matching $M$ and $v\in V$, we define $M(v)$ as a neighbour of $v$ in $M$ if $v$ is matched by $M$, otherwise $M(v):=\varnothing$. To simplify notation we understand $>_v$, $v\in V$ as a total ordering on the set $N(v)\cup\{\varnothing\}$, where $\varnothing$ is the smallest element with respect to $>_v$
A matching $M$ in $G$ is called a $\emph{stable matching}$ if for every edge $e=\{a,b\}\in E$ the set
\begin{equation}\label{eq:stability_def}
		M \, \cap \, \big(\delta^{>a}(b) \cup \delta^{>b}(a) \cup  \{e\} \big)\neq\varnothing\,,
\end{equation}
i.e. no edge $\{a,b\}\in E$ is absent in $M$  if $a>_b M(b)$ and $b>_a M(a)$.


%If we assign for each vertex a list of preferences with respect to that vertex's neighbours then we have a stable matching instance. Let $v,w \in V$, define $\delta^{>w}(v) = \{vj \in \delta(v): j \text{ is strictly preferred to } w \text{ by } v\}$. Also define $ \delta^{\geq w}(v), \delta^{<w}(v),$ etc, similarly. Let $n^*(v)$ ($n_*(v)$ respectively) denote the most (least respectively) preferred elements of the neighbourhood of $v$. For any matching $M$ let $M(v)$ denote the vertex such that $vM(v) \in M$. Let $M_1$ and $M_2$ be two stable matchings on $G$.
{\color{red}
Next lemmas turn out to be useful to study $M_1\triangle M_2:=\{ e\in E: \}$

Here, we denote by $V(C)$ and $E(C)$ the node and edge sets of $C$.}

\begin{lemma}\label{lemma:pref}
Let $M_1$ and $M_2$ be two stable matchings in $G$ and let $C$ be a connected component in the graph $M_1 \triangle M_2$. Then either
\begin{equation}\label{eq:pref_first}
	M_1(a)>_a M_2(a)\,,\,\forall a\in V(C) \cap\mathcal{A}\quad \text{and} \quad  M_1(b)<_b M_2(b)\,,\,  \forall b\in V(C) \cap\mathcal{B}
\end{equation}
or 
\begin{equation}\label{eq:pref_second}
	M_2(a)>_a M_1(a)\,,\,\forall a\in V(C) \cap\mathcal{A}\quad \text{and} \quad  M_2(b)<_b M_1(b)\,,\,  \forall b\in V(C) \cap\mathcal{B}
\end{equation}
\end{lemma}
%Let $C$ be a connected component of the subgraph of $G$ with edge set $M_1 \triangle M_2$. Then either all vertices in $V(C) \cap V_0$ prefer $M_1$ to $M_2$ and all vertices in $V(C) \cap V_1$ prefer $M_2$ to $M_1$, or vice versa.


\begin{proof}
Since $M_1$ and $M_2$ are matchings, $C$ is a path or a cycle. Let $v\in V$ be an end node of $C$ if $C$ is a path, otherwise let $v$ be an arbitrary node of $C$. 

W.l.o.g. $v:=a\in \mathcal{A}$, $M_1(a) >_a M_2(a)$ and $b:=M_1(a)\in\mathcal{B}$. If $a=M_1(b) >_b M_2(b)$, the matching $M_2$ violates~\eqref{eq:stability_def} for the edge $\{a,b\}\in E$. Thus, $a=M_1(b) <_b M_2(b)$ and continuing in this way, we obtain statement~\eqref{eq:pref_first}.

%We may assume without loss of generality that $v \in V_0$ and $M_1(v) >_v M_2(v)$. Let $w = M_1(v)$. Then $w \in V(C)$. If $M_1(w) >_w M_2(w)$ then $vw$ blocks $M_2$. So $M_2(w) >_w M_1(w)$. Let $u=M_2(w)$. Then $u \in V(C)$. If $M_2(u) >_u M_1(u)$ then $uw$ blocks $M_1$. So $M_1(u) >_u M_2(u)$. This local structure can be extended forward to hit all edges in the connected component.
\end{proof}


\begin{lemma}\label{lemma:sym_stable} 
Let $M_1$ and $M_2$ be two stable matchings in $G$. Let $J_1$ be the union of $E(C)$ for connected components $C$ in $M_1 \triangle M_2$ satisfying~\eqref{eq:pref_first}, let $J_2:=(M_1\triangle M_2)\setminus C$. Then both $M_1\triangle J_1$ and $M_1\triangle J_2$ are stable matchings in $G$.
\end{lemma}
\begin{proof}
By Lemma~\ref{lemma:pref}, $J_2$ is the union of $E(C)$ for connected components $C$ in $M_1 \triangle M_2$ satisfying~\eqref{eq:pref_second}.

Clearly $M'_1:=M_1\triangle J_1$ and $M'_2:=M_1\triangle J_2$ are matchings in $G$. Let us assume that one of these matchings os not stable, w.l.o.g. assume that $M'_1$ does not satisfy~\eqref{eq:stability_def} for some edge $e:=\{a,b\}\in E$ with $a\in\mathcal{A}$ and $b\in\mathcal{B}$. 

Since $M_1$ and $M_2$ are stable, we have $|\{a,b\}\cap V(J_1)|=1$ and $|\{a,b\}\cap V(J_2)|=1$.
If $a\in V(J_1)$ and $b\in V(J_2)$, then $M'_1(a)=M_2(a)$ and $M'_1(b)>M_2(b)$, and hence $M_2$ violates ~\eqref{eq:stability_def} for $e:=\{a,b\}$.{\color{red} If $a\in V(J_2)$ and $b\in V(J_1)$, then $M'_1(a)=M_2(a)$ and $M'_1(b)>M_2(b)$





}
\end{proof}

\section{Stable Matching Polytope}

Let us define the \emph{stable matching polytope} $P(G)\subseteq\R^E$ for graph $G$ as follows
$$
	P(G):=\conv\{\chi(M)\in\R^E: M \text{ is a stable matching in } G\}\,.
$$
By~\cite{}, $P(G)$ is a nonempty polytope because every graph $G$ has a stable matching.

Clearly, the vertices of $P(G)$ are in one to one correspondence with stable matchings in $G$. Moreover, Lemma~\ref{lemma:sym_stable} helps to understand what pairs of stable matchings in $G$ do not correspond to edges of $P(G)$.

\begin{lemma}
Let $M_1$ and $M_2$ be two stable matchings in $G$ which define an edge of the polytope~$P(G)$. Then all connected components in $M_1\triangle M_2$ satisfy~\eqref{eq:pref_first} or all of them satisfy~\eqref{eq:pref_second}.  
\end{lemma}
\begin{proof}
If the statement of the lemma does not hold, then in Lemma~\ref{lemma:sym_stable} the sets $J_1$ and $J_2$ are both nonempty, and hence we obtain two stable matchings $M_1\triangle J_1$ and $M_1\triangle J_2$ different from $M_1$, $M_2$ such that $\frac{1}{2}\chi(M_1\triangle J_1)+\frac{1}{2}\chi(M_1\triangle J_2)=\frac{1}{2}\chi(M_1)+\frac{1}{2}\chi(M_2)$, what condradicts the statement that $M_1$ and $M_2$ define an edge of $P(G)$.
\end{proof}


\section{Linear Description}
Let us define $Q(G)\subseteq\R^E$ be the polytope described  by the following linear constraints
\begin{align}
x(\delta(v)) \leq 1\quad \forall v \in V\qquad \text{and} \qquad x_e \geq 0\quad \forall e \in E\,,\label{eq:lin_descr_match}\\
x(\delta^{>a}(b))+ x(\delta^{>b}(a)) + x_{\{a,b\}} \geq 1 \quad \forall e:=\{a,b\} \in E \label{eq:lin_descr_stab}
\end{align}
where $x(J) = \sum_{e \in J} x_e$ for any $J \subseteq E$.

Clearly, $P(G)\subseteq Q(G)$ because for every stable matching $M$ in $G$ the point $x:=\chi(M)$  satisfies~\eqref{eq:lin_descr_match} and by~\eqref{eq:stability_def} the point $x$ also satisfies~\eqref{eq:lin_descr_stab}. On the other hand, every integral point in $Q(G)$ equals $\chi(M)$ for some stable matching $M$ in~$G$. In the remaining part of the paper we show that every vertex of $Q(G)$ is integral, thus proving the main theorem.

\begin{theorem}
	For every graph $G$ the polytope $P(G)$ equals $Q(G)$.
\end{theorem}


\begin{lemma}
	For every graph $G$ every vertex of the polytope $Q(G)$ is integral.
\end{lemma}
\begin{proof}
First, let show that every vertex $x$ of $Q(G)$ has a coordinate equal to $0$ or a coordinate equal to $1$. Let us assume the contrary. As every vertex, $x\in \R^E$ is defined as the unique point, which tightly satisfies some $|E|$ constraints describing $Q(G)$. Since $x$ has no zero coordinate, we can assume  that the tight constraints are $x(\delta(v))\le 1$ for $v\in V_x$ and \eqref{eq:lin_descr_stab} for $e\in E_x$, where $|V_x|+|E_x|=|E|$. Moreover, let us assume that we choose the $|E|$ tight constraints so that $|V_x|$ is as large as possible. 

The constraints $x(\delta(v))=1$, $v\in V$ are linearly dependent, in particular $\sum_{a\in\mathcal{A}}\chi(\delta(a))=\sum_{b\in\mathcal{B}}\chi(\delta(b))$. Hence, we have $|V_x|\le |V|-1$. {\color{red}On the other hand if $a=N_{\max}(b)$ or $a=N_{\min}(b)$ then $\{a,b\}\not\in E_x$. Indeed, if $N_{\max}(b)$ the tight constraint~\eqref{eq:lin_descr_stab} for $e:=\{a,b\}$  is... deduced from constraints $x(\delta(a))\le 1$, which is also tight for the point $x$.} Thus, 
$$
	|E_x|=\frac{1}{2}\sum_{v\in V} |\delta(v)\cap E_x|\le  \frac{1}{2}\sum_{v\in V} (|\delta(v)|-2)= |E|-|V|\,,
$$
what implies $|E_x|+|V_x|\le |E|-1$, contradiction.

\bigskip

Now let us assume that $G$ is a graph with the minimum number of edges such that $Q(G)$ is not an integral polytope.

Case $x_{\{a,b\}}=0$ for some $a\in \mathcal{A}$, $b\in\mathcal{B}$ and $e:=\{a,b\}\in E$. In this case, let $x'$ be obtained from $x$ by dropping the coordinate corresponding to $\{a,b\}$, and let $G'$ be the graph with $V(G')=V$ and $E(G')\setminus \{e\}$. Define $H'$ to be the hyperplane $\{x\in \R^{E(G')}: x(\delta^{>a}(b))+ x(\delta^{>b}(a))=1\}$. Then, $x'$ is a vertex of the polytope $P':=P(G')\cap H'$.
But every vertex of $P'$ is either a vertex of $P(G')$ or an intersection of an edge of $P(G')$ with the hyperplane $H'$.{\color{red}no such edg}

Case $x_{\{a,b\}}=1$ for some $a\in \mathcal{A}$, $b\in\mathcal{B}$. {\color{red}vertex of a new polytope}
\end{proof}

\newpage

\subsection{Finding a $0$ or $1$}

\begin{lemma}
Let $x$ be an extreme point solution to $Q(G)$ such that $x>0$. Then there exists $W \subseteq V$ and $T \subseteq E$ such that the following hold:
\label{lemma:rank}
\begin{enumerate}
\item $x(\delta(v)) = 1$, $\forall v \in W$.
\item $x(\delta^{>w}(v)) + x(\delta^{>v}(w)) + x_{vw} = 1$, $\forall vw \in T$.
\item The vectors in $\{\chi(\delta(v)) : v \in W\}$ together with the vectors in $\{\chi(\delta^{>w}(v)) + \chi(\delta^{>v}(w)) + \chi(vw) : vw \in T\}$ are all linearly independent.
\item $|W| + |T| = |E|$.
\end{enumerate}
\end{lemma}
\begin{proof}
Immediate from Rank Lemma \cite{lau2011iterative}. 
\end{proof}
\begin{lemma}
Let $x$ be an extreme point solution of $Q(G)$ such that $0 < x < 1$. Let $W \subseteq V$, and $T \subseteq E$ be sets that together satisfy $1-4$ of Lemma \ref{lemma:rank}. If $W$ and $T$ are chosen so that $|W|$ is maximized then for any $v \in V$ if $w = n^*(v)$ then $vw \not\in T$.
\label{lemma:fav}
\end{lemma}
\begin{proof}
Let $v \in V$, let $w = n^*(v)$ and suppose for a contradiction that $vw \in T$. Then 
$$x(\delta^{>v}(w)) + x(\delta^{>w}(v)) + x_{vw} = 1. $$
Since $w = n^*(v)$, $\chi(\delta^{>w}(v)) = 0$. Therefore we have
$$x(\delta^{\geq v}(w)) = 1.$$
Since $x(\delta(w)) \leq 1$ and $\delta(w) = \delta^{\geq v}(w) \dot\cup \delta^{< v}(w)$, $$x(\delta^{<v}(w) = 0. $$
Therefore, since $x_e > 0$ for each $e \in \delta^{< v}(w)$, $$\chi(\delta^{< v}(w)) = 0.$$
Then we have that
\begin{align*}
\chi(\delta(w)) &= \chi(\delta^{\geq v}(w)) + \chi(\delta^{<v}(w)) \\
&= \chi(\delta^{\geq v}(w)) \\
&= \chi(\delta^{> v}(w)) + \chi(\delta^{> w}(v)) + \chi(vw).
\end{align*}
So if $w \in W$ this contradicts condition $3$ of Lemma \ref{lemma:rank}, the linear independence. But if $w \not\in W$ then by the equivalence just demonstrated the sets $W' = W \cup \{w\}$ and $T' = T \backslash \{vw\}$ also satisfy $1-4$ of Lemma \ref{lemma:rank} yet $|W'| > |W|$ contradicting the maximality of $|W|$. 
\end{proof}
\begin{lemma}
Let $x$ be an extreme point solution of $Q(G)$. Then there exists $e \in E$ such that $x_e = 0$ or $x_e = 1$.
\label{lemma:01}
\end{lemma}
\begin{proof}
Suppose for contradiction that $0 < x_e < 1$ for all $e \in E$. By Lemma \ref{lemma:rank} there exists $W, T$ satisfying properties $1-4$ of Lemma \ref{lemma:rank}. Choose such $W$ and $T$ so that $|W|$ is maximized. First notice that
$$d_E(v) \geq 2 $$
for all $v \in W$. This follows since $x(\delta(v)) = 1$ and $x_e < 1$ for each $e \in \delta(v)$.
\paragraph{}
Let $v \in W$. Let $w = n_*(v)$. We claim that $vw \not\in T$. Suppose for a contradiction that $vw \in T$. Then we would have:
$$  x(\delta^{>w}(v)) + x(\delta^{>v}(w)) + x_{vw} = 1. $$
But since $w=n_*(v)$, $\chi(\delta^{<w}(v)) = 0$. Thus $\delta^{\geq w}(v) = \delta(v)$. Therefore
$$x(\delta^{>w}(v)) + x_{vw} = x(\delta(v)) = 1 \text{ since $v \in W$}. $$
So we have that $ x(\delta^{>v}(w)) = 0 $. That is $\chi(\delta^{>v}(w)) = 0.$
Therefore $$ \chi(\delta^{>w}(v)) + \chi(\delta^{>v}(w)) + \chi(vw) = \chi(\delta^{>w}(v)) + \chi(vw) = \chi(\delta(v)). $$
Since $v \in W$ this tells us that condition $3$ of Lemma \ref{lemma:rank} is violated, a contradiction. Therefore $vw \not\in T$.
\paragraph{}
Now for any $v \in V$, by Lemma \ref{lemma:fav}, $vn^*(v) \not\in T$. Since $d_E(v) \geq 2$ implies that $n^*(v) \neq n_*(v)$ we thus have that $d_{E\backslash T}(v) \geq 2$ for all $v \in W$.
\paragraph{}
We are now ready to give a fractional token counting argument to obtain the desired contradiction. To each $e \in E$ we will distribute one token. Redistribute the tokens according to the following rules. For any $e=vw \in E$ do:
\begin{enumerate}
\item If $e \in T$ then $e$ keeps its token,
\item otherwise:
\subitem if $v \in W$ then $e$ gives $\frac{1}{2}$ token to $v$,
\subitem if $w \in W$ then $e$ give $\frac{1}{2}$ token to $w$.
\end{enumerate}
Then after redistribution by rule $1$ every $e \in T$ has a token. Let $v \in W$. By our previous arguments $d_{E\backslash T}(v) \geq 2$. So there exist at least two edges which each give $\frac{1}{2}$ token to $v$. Therefore $v$ has at least one token after redistribution.
\paragraph{}
We claim that there exist $v \in V\backslash W$. Suppose not, that is $W = V = V_0 \dot\cup V_1$. Then
\begin{align*}
\sum_{v \in V_0} \chi(\delta(v)) &= \chi(\delta(V_0)) \\
&= \chi(\delta(V_1)) &\text{since $G$ is bipartite} \\
&= \sum_{v \in V_1} \chi(\delta(v)).
\end{align*}
Since $V_0, V_1 \subseteq W$ this contradicts Lemma \ref{lemma:rank} part $3$. Therefore there exists $v \in V \backslash W$. Let $w = n^*(v)$. Let $e = vw \in E$. By Lemma \ref{lemma:rank}, $e \not \in T$. Since $v \not\in W$, $e$ keeps at least $\frac{1}{2}$ token. Therefore $|E| > |W| + |T|$ contradicting condition $4$ of Lemma \ref{lemma:rank}. 
\end{proof}

\subsection{Proof of Integrality}
\begin{theorem}
$Q(G)$ is integral.
\end{theorem}
\begin{proof}
Note that it is clear the integral points of $Q(G)$ describe stable matchings of $G$\cite{rothblum1992characterization}. The argument proceeds by induction on $|E|$. Notice in the base case $|E| = 1$, it is immediate that $Q(G) = \{1\}$.
\paragraph{}
Consider the inductive case. Let $x$ be an extreme point of $Q(G)$. By Lemma \ref{lemma:01} exists $e=vw \in E(G)$ such that $x_e = 0$ or $x_e = 1$. 
\paragraph{}
Consider the case $x_e = 0$. If $x$ is fractional then the residual vector, $z$, acquired by restricting $x$ to $\R^{E\backslash\{e\}}$, is fractional. Notice that $z \in Q(G-e)$. Further it is not difficult to show that $x$ satisfies:
$$x(\delta^{>w}(v))+ x(\delta^{>v}(w)) + x_{vw} = 1$$
and so $z$ lies on an edge of $Q(G-e)$ (the hyperplane above intersects this edge) . Let $M_1$ and $M_2$ be the stable matchings given by the extreme points of $Q(G-e)$ which describe the edge that $z$ lies on.
\paragraph{}
Without loss of generality we may assume
$$ |M_1 \cap(\delta^{>w}(v) \cup \delta^{>v}(w))| = 2 $$
and 
$$ |M_2 \cap(\{vw\} \cup \delta^{>w}(v) \cup \delta^{>v}(w))| = 0.$$
To see this notice that if $|M_1 \cap(\delta^{>w}(v) \cup \delta^{>v}(w))| = 1$ then $M_1$ would satisfy $$x(\delta^{>w}(v))+ x(\delta^{>v}(w)) + x_{vw} = 1$$ and $z$ would be the incidence vector of $M_1$, contradicting that $z$ is fractional. Similar for $M_2$.
\paragraph{}
Define $J_1$ and $J_2$ as in Lemma \ref{lemma:symstable}. Since $|M_1 \cap(\delta^{>w}(v) \cup \delta^{>v}(w))| = 2$, neither $J_1$ nor $J_2$ are empty. Therefore $M_1 \triangle J_1$ and $M_2 \triangle J_2$ are distinct matchings from $M_1$ and $M_2$.
\paragraph{}
Further it can be seen that
\begin{align*}
&\chi(M_1 \triangle J_1) + \chi(M_1 \triangle J_2)\\
&= (\chi(M_1) + \chi(J_1) - 2\chi(M_1 \cap J_1)) + (\chi(M_1) + \chi(J_2) -2\chi(M_1 \cap J_2))\\
&=2\chi(M_1) + \chi(J_1) + \chi(J_2) -2(\chi(M_1 \cap J_1) + \chi(M_2 \cap J_2)) \\
&= 2\chi(M_1) + \chi(M_1 \triangle M_2) - 2(\chi(M_1) + \chi(M_1 \cap M_2)) \\
&= \chi(M_1 \triangle M_2) + 2\chi(M_1 \cap M_2) \\
&=\chi(M_1) + \chi(M_2).
\end{align*}
\paragraph{}By Lemma \ref{lemma:symstable}, $M_1 \triangle J_1$ and $M_1 \triangle J_2$ are stable. This contradicts that $M_1$ and $M_2$ are described by extreme points defining at edge of $Q(G-e)$.
\paragraph{}
In the case $x_e = 1$, if there exists $e' \in \delta(v) \cup \delta(w) \backslash \{e\}$ then $x_{e'} = 0$ and so we may obtain a contradiction by removing $e'$ as we did in the $x_e = 0$ case. Otherwise let $z$ be the vector acquired by restricting $x$ to $\R^{E \backslash \{e\}}$. Notice $z \in Q(G - v - w)$. If $z$ is not a vertex then there exists $z^1, z^2 \in Q(G-v-w)$ such that $z = \frac{1}{2}(z^1 + z^2)$. Now $z^1,z^2$ can be extended to vectors $x^1, x^2 \in \R^{E}$ by setting $x^1_e=x^2_e = 1$. Then $x^1,x^2 \in Q(G)$ and $x = \frac{1}{2}(x^1 + x^2)$, contradicting that $x$ is a vertex of $Q(G)$. Therefore $z$ is a vertex of $Q(G-v-w)$, thus integral, and so $x$ is integral.
\end{proof}
\bibliography{StableMatchingPolytopeReferences}
\end{document}
